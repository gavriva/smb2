package smb2

const ( // in little endian
	SMB_PROTO_ID  = 0x424d53ff
	SMB2_PROTO_ID = 0x424d53fe

	SMB2_HEADER_SIZE = 64
)

const (
	SMB2_NEGOTIATE       = 0x0000
	SMB2_SESSION_SETUP   = 0x0001
	SMB2_LOGOFF          = 0x0002
	SMB2_TREE_CONNECT    = 0x0003
	SMB2_TREE_DISCONNECT = 0x0004
	SMB2_CREATE          = 0x0005
	SMB2_CLOSE           = 0x0006
	SMB2_FLUSH           = 0x0007
	SMB2_READ            = 0x0008
	SMB2_WRITE           = 0x0009
	SMB2_LOCK            = 0x000A
	SMB2_IOCTL           = 0x000B
	SMB2_CANCEL          = 0x000C
	SMB2_ECHO            = 0x000D
	SMB2_QUERY_DIRECTORY = 0x000E
	SMB2_CHANGE_NOTIFY   = 0x000F
	SMB2_QUERY_INFO      = 0x0010
	SMB2_SET_INFO        = 0x0011
	SMB2_OPLOCK_BREAK    = 0x0012
)

const (
	SMB2_FLAGS_SERVER_TO_REDIR    = 0x00000001
	SMB2_FLAGS_ASYNC_COMMAND      = 0x00000002
	SMB2_FLAGS_RELATED_OPERATIONS = 0x00000004
	SMB2_FLAGS_SIGNED             = 0x00000008
	SMB2_FLAGS_PRIORITY_MASK      = 0x00000070
	SMB2_FLAGS_DFS_OPERATIONS     = 0x10000000
	SMB2_FLAGS_REPLAY_OPERATION   = 0x20000000
)

const (
	SMB2_NEGOTIATE_SIGNING_ENABLED  = 0x0001
	SMB2_NEGOTIATE_SIGNING_REQUIRED = 0x0002
)

const (
	SMB2_GLOBAL_CAP_DFS                = 0x00000001
	SMB2_GLOBAL_CAP_LEASING            = 0x00000002
	SMB2_GLOBAL_CAP_LARGE_MTU          = 0x00000004
	SMB2_GLOBAL_CAP_MULTI_CHANNEL      = 0x00000008
	SMB2_GLOBAL_CAP_PERSISTENT_HANDLES = 0x00000010
	SMB2_GLOBAL_CAP_DIRECTORY_LEASING  = 0x00000020
	SMB2_GLOBAL_CAP_ENCRYPTION         = 0x00000040
)

// See [MS-NLMP].pdf 2.2.2.5
const (
	NTLMSSP_NEGOTIATE_128                      = 1 << 29
	NTLMSSP_NEGOTIATE_VERSION                  = 1 << 25
	NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY = 1 << 19
	NTLMSSP_NEGOTIATE_ALWAYS_SIGN              = 1 << 15
	NTLMSSP_NEGOTIATE_NTLM                     = 1 << 9 // If set, requests usage of the NTLM v1 session security protocol.
	NTLMSSP_NEGOTIATE_SIGN                     = 1 << 4
	NTLMSSP_REQUEST_TARGET                     = 1 << 2
	NTLMSSP_NEGOTIATE_UNICODE                  = 1
)

// See [MS-SMB2].pdf 2.2.13.1
const (
	FILE_READ_DATA   = 0x00000001
	FILE_WRITE_DATA  = 0x00000002
	FILE_APPEND_DATA = 0x00000004
	FILE_READ_EA     = 0x00000008
	FILE_WRITE_EA    = 0x00000010

	GENERIC_READ    = 0x80000000
	GENERIC_WRITE   = 0x40000000
	GENERIC_EXECUTE = 0x20000000
	GENERIC_ALL     = 0x10000000
)

const (
	FILE_SHARE_READ   = 0x00000001
	FILE_SHARE_WRITE  = 0x00000002
	FILE_SHARE_DELETE = 0x00000004
)

const (
	FILE_SUPERSEDE    = 0 // If the file already exists, supersede it. Otherwise, create the file.
	FILE_OPEN         = 1 // If the file already exists, return success; otherwise, fail the operation.
	FILE_CREATE       = 2 // If the file already exists, fail the operation; otherwise, create the file.
	FILE_OPEN_IF      = 3 // Open the file if it already exists; otherwise, create the file.
	FILE_OVERWRITE    = 4 // Overwrite the file if it already exists; otherwise, fail the operation.
	FILE_OVERWRITE_IF = 5 // Overwrite the file if it already exists; otherwise, create the file.
)

const (
	FILE_ATTRIBUTE_READONLY            = 0x00000001
	FILE_ATTRIBUTE_HIDDEN              = 0x00000002
	FILE_ATTRIBUTE_SYSTEM              = 0x00000004
	FILE_ATTRIBUTE_DIRECTORY           = 0x00000010
	FILE_ATTRIBUTE_ARCHIVE             = 0x00000020
	FILE_ATTRIBUTE_NORMAL              = 0x00000080
	FILE_ATTRIBUTE_TEMPORARY           = 0x00000100
	FILE_ATTRIBUTE_SPARSE_FILE         = 0x00000200
	FILE_ATTRIBUTE_REPARSE_POINT       = 0x00000400
	FILE_ATTRIBUTE_COMPRESSED          = 0x00000800
	FILE_ATTRIBUTE_OFFLINE             = 0x00001000
	FILE_ATTRIBUTE_NOT_CONTENT_INDEXED = 0x00002000
	FILE_ATTRIBUTE_ENCRYPTED           = 0x00004000
	FILE_ATTRIBUTE_INTEGRITY_STREAM    = 0x00008000
	FILE_ATTRIBUTE_NO_SCRUB_DATA       = 0x00020000
)

// List of FileSystemAttributes - see 2.5.1 of MS-FSCC
const (
	FILE_SUPPORTS_SPARSE_VDL          = 0x10000000 // faster nonsparse extend
	FILE_SUPPORTS_BLOCK_REFCOUNTING   = 0x08000000 // allow ioctl dup extents
	FILE_SUPPORT_INTEGRITY_STREAMS    = 0x04000000
	FILE_SUPPORTS_USN_JOURNAL         = 0x02000000
	FILE_SUPPORTS_OPEN_BY_FILE_ID     = 0x01000000
	FILE_SUPPORTS_EXTENDED_ATTRIBUTES = 0x00800000
	FILE_SUPPORTS_HARD_LINKS          = 0x00400000
	FILE_SUPPORTS_TRANSACTIONS        = 0x00200000
	FILE_SEQUENTIAL_WRITE_ONCE        = 0x00100000
	FILE_READ_ONLY_VOLUME             = 0x00080000
	FILE_NAMED_STREAMS                = 0x00040000
	FILE_SUPPORTS_ENCRYPTION          = 0x00020000
	FILE_SUPPORTS_OBJECT_IDS          = 0x00010000
	FILE_VOLUME_IS_COMPRESSED         = 0x00008000
	FILE_SUPPORTS_REMOTE_STORAGE      = 0x00000100
	FILE_SUPPORTS_REPARSE_POINTS      = 0x00000080
	FILE_SUPPORTS_SPARSE_FILES        = 0x00000040
	FILE_VOLUME_QUOTAS                = 0x00000020
	FILE_FILE_COMPRESSION             = 0x00000010
	FILE_PERSISTENT_ACLS              = 0x00000008
	FILE_UNICODE_ON_DISK              = 0x00000004
	FILE_CASE_PRESERVED_NAMES         = 0x00000002
	FILE_CASE_SENSITIVE_SEARCH        = 0x00000001
)

// Possible InfoType values of SMB2_QUERY_INFO
const (
	SMB2_O_INFO_FILE       = 0x01
	SMB2_O_INFO_FILESYSTEM = 0x02
	SMB2_O_INFO_SECURITY   = 0x03
	SMB2_O_INFO_QUOTA      = 0x04
)

// Possible values of SMB2_QUERY_DIRECTORY.Flags
const (
	SMB2_RESTART_SCANS       = 0x01
	SMB2_RETURN_SINGLE_ENTRY = 0x02
	SMB2_INDEX_SPECIFIED     = 0x04
	SMB2_REOPEN              = 0x10
)

// For SMB2_QUERY_INFO.InfoType == SMB2_O_INFO_FILESYSTEM
// File System Information Classes
const (
	FS_VOLUME_INFORMATION       = 1  // Query
	FS_LABEL_INFORMATION        = 2  // Local only
	FS_SIZE_INFORMATION         = 3  // Query
	FS_DEVICE_INFORMATION       = 4  // Query
	FS_ATTRIBUTE_INFORMATION    = 5  // Query
	FS_CONTROL_INFORMATION      = 6  // Query, Set
	FS_FULL_SIZE_INFORMATION    = 7  // Query
	FS_OBJECT_ID_INFORMATION    = 8  // Query, Set
	FS_DRIVER_PATH_INFORMATION  = 9  // Local only
	FS_VOLUME_FLAGS_INFORMATION = 10 // Local only
	FS_SECTOR_SIZE_INFORMATION  = 11 // SMB3+. Query
)

// For SMB2_QUERY_INFO.InfoType == SMB2_O_INFO_FILE
const (
	FILE_ALL_INFORMATION    = 0x12
	FILE_BASIC_INFORMATION  = 0x04
	FILE_ACCESS_INFORMATION = 0x08
	FILE_EA_INFORMATION     = 0x07
)

// Possible values of SMB2_QUERY_DIRECTORY.FileInformationClass
const (
	FILE_DIRECTORY_INFORMATION         = 0x01
	FILE_FULL_DIRECTORY_INFORMATION    = 0x02
	FILE_BOTH_DIRECTORY_INFORMATION    = 0x03
	FILE_NAMES_INFORMATION             = 0x0c
	FILE_ID_BOTH_DIRECTORY_INFORMATION = 0x25
	FILE_ID_FULL_DIRECTORY_INFORMATION = 0x26
)
